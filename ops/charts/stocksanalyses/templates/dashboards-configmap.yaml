apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "stocksanalyses.fullname" . }}-dashboards
  labels:
    grafana_dashboard: "1"
data:
  stocksanalyses-overview.json: |
{{- $m := .Values.metrics.metricNames -}}
{{ (tpl ( .Files.Get "ops/grafana/dashboards/stocksanalyses-overview.json" ) . | replace "$http_count" $m.httpRequestsCount | replace "$http_bucket" $m.httpRequestsBucket | replace "$uptime" $m.uptimeSeconds | replace "$cpu" $m.systemCpuUsage | replace "$heap" $m.jvmHeapUsedBytes | indent 4 ) }}

